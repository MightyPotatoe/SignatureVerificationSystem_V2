function [Y,Xf,Af] = siec5(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 17-Jun-2017 13:49:44.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 72xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [0.731781438597027;-139.67809614045;-6.22399140073731;-10.6954863445189;-424563.769191375;-365995.910311372;0.769465139513959;-309.998152735026;-57747.0178512429;-0.642509667640742;0.0627627789773799;-2316798.42323147;1.07778758989485;-4485.92655407378;-1950894.63084464;19.5947555147309;-25831243.7267415;-901355927.789698;0.74937883665408;-52.7829331624028;-5107.65096099448;-7361.93071910492;-139775.847319191;-1014.31020842636;1.23846924450643;-60.4668921875996;-61.59801160536;-4771.48308632129;-130800.519909082;-4640.84170873578;1.90279617071431;-3376.5246026747;32.9857322133898;-54.234118210933;-231036747.228803;-267910427.84512;0.931429714534679;-187.897131185755;0.137935178144896;-135.903186866998;-962778.281548234;-822692.32648695;0.835158776349684;-312.742726544549;-52935.0904604398;-1.70888310491452;-7983.07776405214;-2701072.10712623;2.01137525600453;-6943.04179944395;-4214834.70273216;305.102922338212;-31129869.452185;-2094919242.36447;1.25211725405646;-112.35140856667;-13050.2389922978;-13882.2036055864;-205089.216251817;-14.102505647775;0.764880443249321;-25.2113186642857;-10.8391650824729;-3589.70887204232;-28439.1437844035;-400.297998559865;0.978773372676597;-1978.38083962529;-1.8018309705546;-152.143799323576;-88169321.7696154;-91339822.4950313];
x1_step1_gain = [0.362099955964268;0.0142891939339708;0.0001106702169099;0.000230226938683793;4.70845183025985e-06;5.46435501877343e-06;0.332346314882759;0.00645217318079606;3.46338738953271e-05;6.33125138492855e-05;8.32645622590031e-07;8.63260185843262e-07;0.120038068348964;0.000445937024276581;1.02517554076088e-06;8.90894537642196e-07;1.20947353974031e-08;2.21887937055251e-09;0.387073109569554;0.0375235375065871;0.000389865806990835;0.000271014285220916;1.40672342440759e-05;1.47365321437939e-05;0.331882280561719;0.0326764185642363;0.000216823172410909;0.000414849428382867;1.51900404338812e-05;3.11281751293595e-05;0.1046714744894;0.00059258344512117;1.18978707830602e-06;2.10781947046607e-06;8.65663256934353e-09;7.46517842266817e-09;0.3324559588799;0.010647360186444;5.71887334484742e-05;0.000111555923905025;2.07669777198781e-06;2.41322666826048e-06;0.334325977650236;0.00639375535402124;3.77796552722018e-05;6.21294222855509e-05;8.57400043612096e-07;7.40442897304534e-07;0.105584756812957;0.000288353866332783;4.74441917671232e-07;5.00885122358384e-07;4.99913725198616e-09;9.54689961975271e-10;0.327055970209877;0.017418715227591;0.000152907094860279;0.000142078675192976;8.22340189858684e-06;3.29596926990056e-06;0.395686511044668;0.0778672003449565;0.00087308865894471;0.000544857510781588;7.00950520520508e-05;8.41563313536742e-05;0.119689168028534;0.00101098329090608;2.33471408022419e-06;4.37500573061781e-06;2.26836265788485e-08;2.1896149181682e-08];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.3864114506065195;-1.2982012864728476;-0.94984823646146888;-0.81328324623474246;-0.56768365252929809;0.10386742749827811;-0.094702627072201354;0.38415878050087343;-0.84817656499181959;0.92127557341165678;0.61021415573627535;-1.427819018099159];
IW1_1 = [-0.011573978978840714 0.19393577970283549 0.14761199829320909 -0.087565108863461083 -0.19000296406901893 0.28314330079987982 0.21867145021331505 0.18085349565225731 -0.16216518880725919 0.28843711220496387 -0.15317894315086722 -0.18054581878421308 0.16961963307548708 -0.22701909621107658 -0.25926721927390184 -0.25213828445738995 -0.059318714478661036 -0.03588649839439479 0.13822601092615183 0.253555047783451 -0.15614760990988685 0.26374956743758143 0.042861397546173151 0.13979668979499302 -0.15904848636994706 0.10754053679463627 -0.03977674061905101 0.022882955777332313 -0.10531899030803056 -0.069594026928288991 -0.15572918009991718 0.036818352650663015 -0.27604446564915813 -0.22942639396692924 0.16004050012286852 0.15674980577728184 -0.29062027434503257 -0.27615133586547547 -0.20108291824908406 -0.28136150791465103 -0.11757035342841018 0.16076360851614124 -0.38606851807971554 0.14009880457459234 -0.18141114578605369 -0.29573607753384429 -0.047632892505880299 -0.082371274582623263 -0.053771171739817811 -0.16248957037354383 -0.27603130171183704 -0.12868972171210166 0.22676636246370749 -0.14101351606788776 -0.30023331926725377 -0.36364574008543676 0.35284294300973579 0.2011162956733567 -0.17597033113002325 -0.027462907510576531 -0.26263547645886881 0.18729285842329876 -0.32620293932998767 0.26421268769399198 0.0085343518769161759 -0.15324533236921919 0.059208864012781214 -0.25945173980016556 -0.11900622975295788 -0.19010703562402559 0.02208984293913864 -0.19183166187447009;0.20475144580040527 0.24618280739924867 -0.14485255751791951 -0.32229308037922294 0.24857761763979516 0.25276589672367861 0.23433398407203992 0.13203867566973365 -0.30753317397300578 0.20420005962363122 0.2602046246998776 0.048865386101118541 -0.2110374413017255 0.097148956527905117 -0.10969154069130094 -0.11802004910552909 0.31294704554923147 -0.10725123366663877 0.30394746958152979 -0.1027695038067675 0.059544483012774582 -0.2721773755199694 0.17272356017221022 -0.05092524591066603 -0.13193772948412272 0.28910778947910154 -0.3598877769769358 -0.0071147441810817478 0.078740016282706216 0.24856003658900486 0.065328856665263446 -0.16366423913567099 -0.12492333223521568 -0.11594312850458265 -0.27896264945354193 0.16497821025292658 -0.012508362045082018 0.050227043364304794 0.039469868712404377 -0.087269130251252533 -0.0050625501102905196 -0.016434077629798264 -0.13531067959701745 0.095792359005953814 0.38247815393720763 0.014853218961605349 0.22122439065705538 0.14168600563709152 -0.41724891648450013 0.31683657672616139 0.32469699871394503 -0.35387955578561148 -0.3994408405158944 -0.021738775690598833 0.20967561247409733 0.32329832495406485 -0.34854536940311365 -0.16881514295345301 0.27281643581929926 0.016345807820983705 -0.074071244253356622 -0.37284102048206597 0.22852984855673139 0.13318043277555836 -0.15985074620002951 -0.14544214048540577 -0.1246900235399464 0.23424208289558657 -0.12850244112788758 0.18700288391042044 0.24352792167206841 -0.014583978142851214;-0.65128062940690923 0.34533390821296439 -0.075538869079632365 -0.4374705615866748 0.0067358007372767996 0.087213692371177265 -0.16939970916681893 -0.15929566713726723 0.043372294200310094 0.16109299524417489 -0.012115766011470399 0.06097365705468686 -0.011091277803187942 -0.32653563585143652 0.091471648767875266 -0.15774371688508668 -0.033264516717752705 0.0010010506400135266 -0.037387671275011386 0.11395878684931814 -0.042052086402146152 0.2518152447531587 -0.017760354891577075 0.018496068954235646 -0.24433730350365754 -0.50799709538966398 0.48569622428146919 0.28229109660849655 -0.41839911001221475 0.034828798575827609 0.0048051972124729305 0.20241563848700081 0.28650091606977174 -0.096136068976666655 -0.29532864069492426 -0.26785703131755101 -0.041669330476227263 -0.3782397192464827 0.33275080195867962 -0.13940336283803004 -0.035443940321937303 -0.29068666076850147 -0.46651287184019991 0.24728449733984359 0.20583713779994012 -0.2589566536405058 -0.13198789552311124 0.11966192832294144 -0.50974626820779045 0.1346974768570067 0.073554786212757517 0.34950593598998769 0.25594188798239148 0.15737173868450285 -0.097158271088017403 -0.19503757151954204 -0.027489546362064736 -0.24773409912053732 0.050461777542618866 0.36039489582432777 -0.65074041570066676 0.36781692170523406 -0.040637576909132098 -0.18213785307721864 0.12396001697951881 -0.24551372982702285 -0.6680871595869573 0.13367935193322864 0.11659637889918564 -0.24065162363858048 -0.10358984271158672 0.099155902800826229;0.1099553468298511 0.15910148593647908 0.32617707304967303 0.14345004533898018 -0.33198320105508 0.16982492247427186 -0.2500879983935112 -0.19516667430618609 -0.32639795693711865 0.0085559316780130963 0.1199937526549798 -0.099941304380125676 -0.071138974663050594 0.23824402175296694 0.18314815131423512 -0.20492198409444468 0.26676035551851357 0.10633162686708122 -0.15061845131347829 -0.064593522519633823 -0.13731896315725414 0.037890583679008792 0.24115002370115546 0.23847884740461689 0.1416285909304951 -0.0033645156025710254 0.078926400600071236 -0.094860981429105637 0.28758688526398662 0.24278175322665463 -0.13315584234243064 0.28388788632544626 0.12236784459533454 -0.089077469663726608 0.10809076138140153 -0.14594073944814198 0.18797701150385876 -0.21404648108750399 0.097260717602872748 -0.28171739529452922 0.19266922770147352 -0.11574184910931021 -0.13165245432915387 0.18386611285185295 -0.07020904172815301 0.13101673674367881 0.037553385555987404 0.03877820415559341 -0.15490927160270204 -0.11948924315263362 0.27806181946156244 0.060916572203446227 -0.041658723239526602 -0.25017806478284865 0.14383413451410421 0.26068047651948606 -0.2059337089160653 -0.11182881642493858 0.16247314470075397 -0.2264276332448322 -0.081610786388934056 0.070578716126322036 -0.12476243963943076 0.22597445138280658 -0.26378302331737802 0.041582473742843525 0.096592828852117715 -0.20444999253669849 0.06301451685730898 -0.071580977366203516 -0.11124959789086637 -0.064714880444674674;0.2579381839699445 -0.1620635031189113 -0.10987742845304239 0.030953307502467175 0.21865271556172497 0.27026797438752648 0.1640208034653578 0.071575030151212179 0.023727664080393139 -0.30384448703436867 0.15688242968805285 0.19281116455521347 0.057498846979180215 0.29227265235529903 0.025521183208219566 -0.18352058269221869 0.31299161342620768 -0.27542083538613826 -0.13128880060423898 -0.26831208751730168 -0.056514839125278715 -0.16067708002688652 -0.048568898593712419 0.062397409363409075 -0.096583187067245724 0.24015824700701016 -0.029790036109164572 0.016520863045733299 0.14961698016434591 0.16714299009190159 0.12382859479604956 0.094688037726487415 -0.1293877764426766 0.1630422360439566 0.14662801963883937 0.022619384727820251 0.078087355799104891 -0.063792674463529569 0.30379846467399874 -0.14893611630020934 0.11911232618688229 -0.31786237078276403 -0.15044836954335714 -0.20874486935810077 0.24798922778213617 -0.1163851463023151 0.11921974193009204 -0.28274698107253959 -0.3929247599435487 0.11722921316503709 0.21937712872184373 0.16563804332176862 -0.19509013115637466 -0.10057926434661002 -0.231408401933796 0.64036290115806949 -0.19215063239240288 -0.058766374677342033 0.3336123163572412 -0.017481076135874758 -0.0057672196151654356 -0.27629129753275466 0.16259568003036581 -0.18397532852205845 -0.076617855446814889 0.30762671262414548 0.12287175184301184 0.33791666593434644 -0.24234255224380211 -0.23502022638535813 -0.15064327084491314 -0.23104580371377068;-0.19658384998518891 0.15323435135679447 0.26017641364406308 -0.021330277879063303 -0.25921511691060117 0.21219467805669864 0.10605948465773168 0.16704590415049328 0.2232744440622545 0.27027320083330131 0.039817586540214847 -0.12106715844521822 0.055799802987892694 0.18261332998214977 -0.18971330577694456 0.1926344617558706 -0.12024095839855768 -0.14198680264355509 -0.25150562395014969 -0.027881591080386712 0.054484538900180401 -0.19996986943245468 -0.11536224295434563 0.07923407721081209 -0.19561518799990094 -0.19201052294166346 -0.1290490863655491 -0.17623730574528623 -0.17696073327738648 -0.01887906053744361 0.15791322716216885 -0.16895352093866897 0.048105307224962687 -0.25886382709901407 0.12574228208388197 0.092648148057552823 0.12922056047624789 0.22511492074428291 0.12170785579357547 0.24108885714952968 -0.14512272915803792 -0.15760311790983528 0.12116898368029888 -0.10751605717786845 -0.037299643403929737 -0.075396607487283704 -0.16013295677403314 0.010605605891924155 -0.26434129364525327 0.18785248994281514 -0.034566907416351253 0.27914254705458158 0.2647362147313928 0.21428927573226991 -0.051096564640897686 -0.25461698900551721 -0.082630479142779628 0.19000874657765068 0.2088276228895615 0.1717023303604614 -0.11194318741669217 -0.28654518373507926 0.22146819987398339 0.18723690068147458 -0.10042788882487812 0.20911707664146337 0.29316646758426751 -0.079478830606721437 -0.130458863795688 -0.010753238937914987 0.21791111049514331 -0.165688478432967;0.0033416507218367777 0.14490773995734202 0.050483059913455357 -0.0072591630946877671 -0.14687405216684735 -0.2209769240549001 -0.2408332534111485 -0.007623450724082579 0.05011807147947215 0.074081728556074228 -0.20987314978283797 -0.027353337257892244 -0.22575792680914913 -0.17388935818078843 0.13447257618682701 -0.11209140427765379 -0.23086752676277486 -0.16264416708171331 -0.14530399527228818 0.26069943346218794 0.18444932444955245 0.10629008577397367 0.22014918355134291 0.28604123870068754 0.24727992467538809 -0.026909929587152017 0.1455772293780456 0.0072603753884831462 -0.050550296362398432 0.17377237906475551 0.21273325388520364 0.18965749265381207 0.029153930084673017 0.067016367981645286 -0.15513991186091841 0.18269849264299634 -0.057508665720344958 -0.11589425151553794 -0.14185089689405481 -0.31467173865188669 -0.17498893504287719 0.020112142607497042 -0.16102071177457908 -0.11262759779170479 -0.02050216799876035 -0.0080306226476007554 -0.13700974227369286 0.098553909072009727 0.11164281942792642 0.25089229275213076 0.29362171911351659 -0.11419901068452067 -0.3136588785318275 -0.13475593055370272 -0.18353267922027083 -0.062104099808597449 -0.13063421592262794 0.09191421939428325 -0.18275203880711732 -0.1809128656281285 -0.21279775168765083 0.22884252106579023 -0.062157301266538303 -0.18459494634510798 0.31244281119217948 -0.32172522055287978 0.073953361225446504 0.31464980292008649 0.0099130367209317276 0.16846516526886837 0.30431528785147327 0.094993170686455075;-0.33200265992049127 0.1221227753526315 -0.066294191376934125 0.0013894307946494475 -0.1079533056978406 0.042323590049023287 -0.079230889380706368 -0.27297636301927652 0.15011847676094162 -0.07876179248141163 0.28470358984915467 -0.32335127989942813 -0.26853968612042822 -0.13782782755406309 -0.26670493460046912 0.3249100681751102 0.23251881807645711 -0.16356494043859934 -0.17594201231319251 -0.16797558737515059 -0.035209612923598824 0.02830217013596496 0.17175116313916214 -0.2566047785390605 -0.42197199864341101 0.024888191260347411 -0.12150400816464151 -0.11673461999681337 0.15994142938698741 -0.067790553676868981 -0.19041362323334135 0.21188745541741721 0.29193854064003855 0.29269992974920894 0.19972216878628879 -0.19530846181172024 0.019405107680409241 -0.21955385226522783 0.26005237859677371 0.10126692059573067 -0.29754354593334303 0.19324617374555197 -0.54240593535333526 0.34957214310150647 0.035593162924388466 -0.071666905230673025 -0.09453367482284035 0.12449471905261798 -0.46027166750147935 -0.17116175362819128 0.06292578703234937 -0.04229999126913319 -0.04913698420210167 -0.26434927309422568 -0.32924514422812701 -0.12714105195540831 -0.22543714883319491 -0.21407878194395222 0.054549496736330659 -0.0051404950287849104 -0.42790165943647274 0.048901952797688227 0.12858795247951718 0.086854003756890619 0.21017629663891088 0.19634838645450395 -0.17873542736385956 0.048369444202173643 0.23483014391610318 0.029554238012828412 0.19831273648055289 -0.090620629902187846;0.06717234432053576 -0.081096701848506828 0.0021333934046089752 -0.18746090625189665 0.086870359014939766 -0.15102811120732085 -0.0079179867546472285 0.17512850548674619 0.21604929534753226 -0.33165012117195702 -0.061635709367332002 -0.32138671730745505 -0.36068592462989379 -0.029753691305880813 0.35141645786022951 -0.15213507442360297 -0.14734863483916452 0.14646591510019832 -0.19837829997727763 -0.036916767189189265 0.46426248415860699 -0.15226278317499478 -0.2711453727517622 0.023311497219752716 0.22085178493234195 0.27379434137163922 -0.37855694813141039 -0.13258135005796665 -0.038113138730197192 0.3505289919053321 -0.10517094550935663 -0.19429485040955996 -0.2448618448457624 0.14829499547553351 -0.27709751483319256 -0.13257716043623588 0.085016468576598794 0.12473670096095613 -0.11120165577999845 0.098550646800132632 -0.12083149500294042 -0.20603262160702002 0.36816053168341734 -0.0017977377822039633 0.2985977891652023 0.29426064144901382 0.094602517787186077 0.083608327451549155 0.10725528779471148 0.11827011331058927 0.26728547737665237 -0.10036815060773095 -0.21670979581847763 0.14917856748584532 0.25430663046027024 0.62856019156276588 -0.44750913300101436 0.089030268643349314 -0.0053409387533568369 0.29479696783500348 0.019182671182731963 -0.41411069443962539 0.044234450744608474 -0.1479200082943504 0.016149488265440017 -0.19877523060267965 0.076448073423124513 -0.040131322788326214 -0.083660439239319373 -0.34823898862705949 -0.099945329522642373 0.30022759368683416;0.19404982426137748 -0.20904142746411183 -0.1059352352119064 -0.21102766411315685 -0.13065767118194871 -0.18337586919964122 -0.12435008202691744 0.078402969962278746 -0.14709085496237814 -0.14105945418756469 -0.16487294262593283 -0.22931080792408706 -0.047477962731411083 -0.24567616470898926 -0.0023564525767848397 0.17709577280207336 0.17726234411298247 0.28426436952639755 0.27431877602501759 -0.023243837540306678 -0.25390587014089572 -0.29604917127726771 0.27084503627445472 -0.18579264840975782 -0.2004479154411713 -0.14047298380415851 0.14692402113068581 -0.080116650496396075 0.09402407894919193 -0.058140446275493946 -0.057400218445751557 0.026159308648927002 -0.34132690776261065 0.20268061606953236 0.087596420801892394 -0.11306418444206125 0.13461074711215362 0.072381825553090404 0.013638451859111313 0.054824652567467533 -0.080719551273669296 0.2310999093262093 -0.07363138812278934 -0.22522130734228857 -0.17039192749739598 -0.24902593360052294 -0.22382450059185707 0.2654023807708229 0.15868787910593588 0.055080081939638988 -0.0040052967211759473 -0.30805132348918596 -0.22307786998004658 -0.059680750431519686 -0.12521281647356661 0.095710830449004983 0.19711334872048594 0.31986565961327035 0.049899528799222201 0.2347134805084122 0.25021937698938934 0.012997173145002237 0.21738619329869283 0.004208337438532707 0.15023598639495267 -0.047729309914243907 0.17404030099351048 0.027027590190170727 0.25581907319188513 -0.11681596481363733 -0.21800752274567883 -0.18066908115853395;0.81916962016022588 -0.50735365764854989 0.51538223693311391 0.02485716544800836 -0.38144974887841926 -0.14217878550833404 -0.062302540779004038 0.81821469814860071 -0.22000566033857 -0.29548387773664209 0.17636235588832067 -0.29591718774644388 -0.69101875274711366 0.30118932111040109 -0.056619794046612132 0.13699803108678138 -0.0040102452326611282 -0.28036049712156524 0.27776981584652077 -0.45792408968768822 0.57649140203617921 -0.50861410005410779 -0.17613330478096803 0.39181944406581576 0.19918071577279167 1.091348358053329 -0.24797008244688004 -0.48244615958073189 0.20118609358015638 0.59961022292498745 -0.40217641670742488 0.13412746087485058 -0.077370327071264788 -0.03861140325237996 -0.51083665780447762 -0.017480191106888927 -0.29591056775664693 0.70163619023924007 0.1648986792688418 0.26161259954278315 -0.49750335634744436 -0.33617438493626095 0.62602467800600647 -0.0053682037652324262 0.33028367926896879 0.43652071945461329 -0.008347048649496612 0.058720419101018023 -0.28085585766047705 0.65338070248479996 0.63676709467214443 -0.065277067007049341 -0.7108146802013221 -0.016725078452166857 0.62485112186545499 1.4054256639106122 -0.5869580677754439 0.16068415896210783 0.32944264888455171 0.25738394946998272 0.094197896491730437 -0.80560711622337366 0.037267520078532783 -0.013331881491876285 -0.31550323368508226 0.30877450683338753 -0.25216477326463976 0.39551373994535993 -0.59382892193206693 0.076014475411727081 0.25561999477560904 -0.22124127611046088;-0.46188310612959688 0.084868879294355298 0.082560841165400273 0.17473520984413005 0.11745741941595174 0.23901695337524678 -0.22189247372663506 0.021227019633013443 0.16337001402205631 0.39374668146477709 -0.21708451764549785 0.04148490977517779 0.12069444085374105 -0.0062287222256162452 -0.16484195903010196 0.16607000742585601 -0.22653422974115547 -0.077476896269480788 -0.047078792711915507 0.32006221006900859 0.20209469181301928 0.38065726579144976 0.018232221590580241 -0.010118676476042412 -0.25161889619853878 -0.047285686296846395 -0.019752800877591251 0.083505907323773207 0.042482280355210227 -0.26130432943705473 0.19751643459755205 -0.3026276497955368 -0.13375632476236399 -0.22351164679719929 -0.052006706185040844 -0.24678616667130573 0.19899787385556689 -0.22330816653106667 0.02556609052460896 -0.020838332173395094 0.20039047157415521 0.10943140937660083 -0.30905742716460194 0.34918455373411394 -0.18326857617678169 0.00029968573159358221 0.33524316795747644 -0.11660195404581103 -0.31478128938625627 0.20694983950791176 -0.1095610472263058 0.28500150766641003 0.13929180001218749 0.23972643629633847 -0.10786367343679525 -0.034792277111530462 0.24141198391997351 -0.29860162939354484 -0.25465357885355416 0.1345557380591601 -0.44480689011677488 0.33355970284485686 -0.060349722675860799 -0.1419458771063743 -0.13605095987885474 -0.045785518469885565 -0.25159530728617785 -0.096760096592512584 -0.16040656684213841 -0.15123990915314711 0.054693677192029805 0.24007967038813274];

% Layer 2
b2 = [-1.1645780290032195;0.7807495171032538];
LW2_1 = [0.056536192165979035 0.61083094049078579 -0.72610181902052129 0.59446890123198703 1.5928237349525243 0.56381725835563057 -0.46241378475660116 -1.4426392135518085 0.86744596351874037 0.25461627584500102 2.4665970837797384 -0.26847061165128278;0.96689280840556369 -1.2273837834555177 1.1863849391961541 -0.44137722710150462 0.081986138353585689 0.43806312014374482 -0.4406256492436626 -0.35763376252693746 -1.1507158383468585 0.22910941384360861 -2.3510723304427721 0.66053606795702768];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
