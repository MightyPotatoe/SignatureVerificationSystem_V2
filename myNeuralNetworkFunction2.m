function [Y,Xf,Af] = myNeuralNetworkFunction2(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-May-2017 17:11:14.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 72xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [3.71245784566554;-3929028.35064008;-1590152706.68205;-528120499.269332;-490409764962386;-134937895176473;4.794596931785;-46041177.9080124;-679814253089.31;-8351595.74214846;22940874091.8997;-1.86297537556351e+16;7.43506083418563;-174085444.661351;-4843208291225.69;388411497.476366;-1.21703027024724e+15;-6.73131001354012e+17;3.87637566599703;-1471271.19291534;-3766775054.52896;-5127014216.80281;-29980949523767.2;-238586554716.759;6.17264624204963;-4473027.59285446;-11920943.4623714;-2714677969.87904;-356923520926131;-42068101640479.3;12.1327865662416;-425300408.17533;740002497.785877;830622964.935925;-7.91040157497238e+18;-1.90573858690709e+18;5.50675675675676;-71265471.6579518;-13171755.2779986;922449.780868766;-1.80942646170433e+17;-4.21995799159649e+16;4.48264365188234;-4417488.21917413;-19963419167.0134;-325004946.412627;-7110113622448.32;-655000021915552;12.0193279071391;-34094704.7723669;-373991301837.618;3913562298.7755;-1.37953911366233e+16;-4.05028554097749e+16;5.8767149375124;-2274519.32450573;-5457468529.46718;-1283729336.28378;-22952066148258.8;99341708925.2824;3.89616423827681;-431174.558144614;-3256705.16626334;-786180921.484976;-5087846796498.99;-16660720956.1778;5.42113352223508;-17401931.956848;7898987.81818549;861499.08540119;-8.63233986276559e+15;-6.54530048235807e+15];
x1_step1_gain = [0.149923517027431;5.09017476196289e-07;8.98932509898321e-11;4.63732065207163e-10;3.97792633350657e-15;1.41694961848243e-14;0.0544018664592007;4.34575154721257e-08;2.94199040239153e-12;2.11330385369775e-11;2.65528159569538e-17;1.07354991570317e-16;0.0336467131428946;1.1508893411696e-08;4.12956471057187e-13;1.33889384168184e-12;1.87190318834757e-18;2.97119915990472e-18;0.156539113993862;1.35573094078584e-06;5.2481409063933e-10;3.89772216405959e-10;5.47341451656435e-14;1.56516436759815e-14;0.122510971677709;4.46803717402165e-07;1.10005614093775e-10;7.38428585048352e-10;5.60347209444249e-15;3.11194849393929e-14;0.023695314684282;4.70857327476296e-09;1.10151577392203e-13;8.63461223134723e-13;2.52831706469421e-19;1.04946521011279e-18;0.044206031104061;2.80752305575244e-08;1.59018727034531e-12;1.18165015094299e-11;1.10532244343279e-17;4.73938293196845e-17;0.169545305315912;4.53241762225617e-07;9.63058927298931e-11;1.29438404522981e-10;5.45705385530657e-15;3.03696433566372e-15;0.0830483510614037;6.14154478637821e-08;5.36501979846337e-12;7.04612003262812e-12;6.21150718231704e-17;4.94598000082902e-17;0.181027086172668;8.44246941606972e-07;3.67970659200896e-10;6.81861338072364e-10;3.51045657832878e-14;4.6455235948364e-14;0.197326719879086;4.53007645802194e-06;2.28402179933087e-09;2.49561863759934e-09;3.9126452299353e-13;3.83661540063649e-13;0.0708155861460679;1.15112122195408e-07;1.1560894444818e-11;2.77830890282584e-11;2.31686664133217e-16;3.0556285011202e-16];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4503327366284022;1.2920729991361275;-0.89654314266559232;0.77643230645409389;-0.58094755820990618;0.45782872606020719;-0.23610615613537914;0.050040595717965375;-0.08531006184386547;0.41702019920369099;-0.62541993744599778;0.78057401443364216;0.81787491740771789;-1.2034486589606637;-1.3603960779091249];
IW1_1 = [-0.037857289886835691 0.24572567731218367 -0.25077238185743578 -0.12672554879721065 0.094674227590119273 0.013014852454644198 0.011797868739113163 -0.046122456514416599 -0.019544268015878084 -0.14263418503176209 -0.26370989522058014 0.20667764250022508 -0.13767719838427858 0.16223546858394336 -0.26671780906347631 0.16219437142369572 0.099232862750779152 -0.25089834878641248 0.19945082980270407 0.22350075891976715 0.012402516229961233 -0.053426338132820779 0.15259478094705259 -0.233741377276664 0.19786900673617577 0.21287067476330743 0.23833342930608303 -0.10614621083824548 0.20579890527422087 0.24843113825022345 0.039724367710101287 0.089709312574381625 0.10351165679785451 0.020749881879948459 0.098672612687735459 -0.065440059853016389 -0.14466834817883842 -0.17658011983370747 0.0097406157498158372 0.14090244329946688 -0.26785822128578607 0.23810854929153888 0.11232171028917753 -0.090770736900841031 -0.059121519430125585 -0.04464372918201278 -0.13449863871141599 -0.12369207541988894 -0.20431486080221892 0.1686112237366682 -0.24131634297417379 0.19218846209626303 0.25900963847373321 0.23572028031965225 -0.24300848795301569 0.11143574886072299 -0.23528687949021265 -0.23011681787768581 0.18625412723659446 -0.24716083276553766 0.18272676986613179 0.24000188482884197 -0.071085456892250487 -0.24564969736572079 -0.080731383403619544 -0.22239861748449538 0.012313095414696461 -0.11839803792067624 0.12708396939527106 0.20101556860909617 0.17068415119920186 0.10829290863289411;-0.61272546609056044 0.21168118379506809 0.033413896248490449 -0.14633596450863312 -0.15669363853212662 -0.088129024744022164 -0.03089164024907038 -0.026548548332050559 0.36722227959215686 -0.38418775295439317 -0.021578889116990133 -0.0031215895400057221 0.079877910675340391 -0.25109232543923232 0.36615706848138152 0.11712391188459673 -0.22980068273165752 0.006020502688082522 0.065229429275354869 -0.49750050033734988 0.30235270899122291 -0.15675804919323891 -0.48602045060340127 -0.069217169317652927 0.23091622632062073 0.10071075749198707 -0.067882702140971765 -0.46852082550093127 -0.22201483883114673 0.35630458825157346 -0.1186854646745681 -0.21596757302258995 -0.15640048189247197 0.091931231718090672 0.051503930169444899 0.22819394820484379 -0.017180349313919464 0.095481711988149892 -0.012370748667557255 -0.12265913134862223 -0.19945759415038536 0.14408621642783828 -0.14218797985762566 0.27185243399486553 0.28219124116195893 -0.15002829787855365 0.0085702241248854696 -0.082201280349546352 -0.48281744059208737 0.10316139653846378 0.035482225524037077 0.014575224081702639 0.19662304095838209 0.067055035134463856 0.36906471867248203 0.11544600912821534 -0.2035278537253763 0.11890289281184301 0.030673703052927756 0.44292684516198427 -0.1668464799846418 -0.31858687189253432 0.033221756434670381 0.15838200742405006 0.097939435981324416 -0.12756778698603094 -0.59853225744665639 0.49099795097929305 0.13750943485426129 0.077173568280692703 0.22776626252615853 0.048860387792431507;0.19334053533948486 -0.044686817921443488 0.054841704390476469 0.099039414684623475 0.32037959859041948 0.29608940875684442 0.31993574779880463 0.051820796862585505 -0.14748322432034977 -0.25997808286436058 -0.28293407853638053 -0.19696483144945195 0.54541354198222924 -0.28605760955215132 0.23628325058528038 0.069591410053398833 -0.14619334743510734 0.24454520615404288 0.73972562218652405 -1.0700054019821195 0.014490100772239996 -0.81452219315289554 -0.78768112394044998 -0.035822350767493016 -0.51222375965006073 0.46340985865018086 -0.40881545239648365 0.038753408503321152 0.42954817853541677 0.16692540860755478 -0.4136758005344589 -0.071410636245425416 -0.068665682361769467 0.0035153323332597014 0.00087105449454720051 0.32247863517088132 0.24112201737720687 0.018160528439773997 -0.23789723250195399 0.075102879871026804 -0.07053702915971613 0.0078432032341820349 -0.10920930709188256 -0.24815321551059494 0.19643582412793723 0.072584871089130143 0.10080691738727564 0.039345410845861094 -0.45678376559389638 0.34053933015366411 0.40101245734612068 -0.069896180085795775 -0.54934619075359636 -0.016061287157613791 -0.47415286380066785 0.26418212100088773 -0.31149958719153059 0.15158395229693136 -0.11084163711635414 -0.12398870085399762 0.82227865205106054 -0.47754125083860099 0.28234932226287213 -0.2663211006801291 -0.064350595372858796 -0.056571279500937995 0.27496445797318059 -0.34167814808287672 -0.035537245157150434 0.11399873011897223 -0.081353263614672905 0.016452129789753842;-0.078440278434690175 -0.25422678264397353 -0.12951464000213184 -0.019176214935955265 -0.23475095152832676 0.10853711891793949 -0.10370973760536444 0.27575230950520968 -0.1344937397316473 0.17590060565522445 0.031504546596580321 0.22429782119522107 -0.31550886419604995 0.15487771026973121 0.079400001381731367 -0.010606354711694964 -0.26567138030589793 0.23170917009051115 0.18393821700107679 -0.019332458587195386 0.19459487777519976 -0.28643795790822579 -0.13962662426262865 0.2495051217213651 0.037326922984224888 -0.04785125951079016 -0.11789716251721354 -0.12707137234169633 0.2098483271685529 0.28832199876635045 0.083102130298390253 0.27334504025296319 -0.13848105528418028 -0.2212940454673471 0.0082887238964514474 0.038879863570405758 -0.29288932074212337 -0.12205470939615848 -0.234622820588713 -0.055768158519934684 0.20333060826258761 -0.21389574475349513 0.018844538669107763 0.0090537931377766608 -0.20912564445390722 0.044510431389793562 0.29450822045278602 0.086475583081190341 0.084811648702423387 -0.13818340614635696 -0.044847684054467631 -0.24909454678216925 -0.2781245912621369 0.21872902972686767 -0.043339203512288822 -0.17199733290255015 -0.23498385334498859 -0.12523029672088482 0.18706364677664242 0.085729181584776562 -0.073684207641658589 -0.2184632629057657 0.041615226651722147 0.11338686657171237 0.064986724606968763 -0.056295377788028747 0.2233489012635288 -0.28557304629690405 -0.067897420340434847 -0.22484738310574581 0.18757804247303575 -0.2293242776633854;0.18267714381526892 -0.073251118259482065 0.077287864553875929 -0.23830447586063147 0.10802782835215494 0.28515316148872999 0.11794364460135473 -0.19632993589359504 -0.081251624922494339 -0.022937079350265302 0.16632606523086457 -0.32863381491390681 0.39417591277608793 -0.14127113478498118 -0.39214629949260515 0.084749634922035008 -0.033685156683722087 -0.16705339432409683 0.33342250973433663 -0.00067929104922517499 -0.19855426836804543 0.30334651247615291 0.31598561601947017 -0.041369306459771209 0.25471018779769805 -0.22026148780290547 0.091922701831615286 0.23642057509839615 0.076246698190415074 -0.022755998289453912 0.12839689786091565 0.2636704387113441 0.061483762585584557 0.0078613331569425751 -0.15055344700686846 -0.27313803553032728 0.17878232315195394 0.11175268299772867 0.23067425425631799 -0.096971017779551416 -0.0080775932839577038 -0.030836378885974292 -0.3345833426834473 -0.0035087581326307903 0.20504957233453314 -0.18714672745070693 -0.051613413501354073 -0.1464631521062314 -0.052452099548282428 -0.20938817914065125 -0.2385588355896712 0.11934762316022482 -0.036539558140669691 0.066720066311157761 0.12432666337409531 0.046920895553852739 0.25793685562013402 0.11556439329925691 -0.025492320291506429 -0.121449050292796 0.23700975626154033 0.0043558899623491014 -0.06681544464359819 -0.11048152389020982 -0.24993790664731744 0.2477380256366904 0.067265473091951605 0.34829850486527003 0.13220992717748276 -0.01464082458782287 0.16290857882787738 0.14506064735437763;0.7242882480315106 -0.594034382816922 0.17091126002901055 0.36008463307253458 0.027542794869271626 -0.25207968094722849 -0.39972798116132602 -0.34165969759619341 -0.28385206735654367 0.89466130347428896 0.34223140994249768 -0.41983762684640547 -1.0396838291057939 0.14448687654484657 -0.83374173435359178 -0.059709594026499786 0.99758785246058523 -0.60851334940039958 -1.2242963343388542 0.84070961636509467 -0.080723883875404495 0.98843319998847534 1.1422617744171393 -0.45688872732649655 -0.917622113913245 -0.29478989832793734 0.16973215269526359 0.49666174095836924 -0.022305419992401914 -0.15057873418522255 -0.63115939518522512 -0.51891064825900934 0.51324957699192741 0.24002620962248294 -0.23194171972441441 0.0318830850063134 -0.4192898281627761 -0.22334111775975707 -0.00989082105130769 0.48785291906633999 -0.064939542346234419 -0.40490248731882017 0.54672831754855866 -0.24169723994319403 -0.21735775450983846 0.49340759409775736 -0.042191528577675219 -0.18649194169026828 0.21791980941222358 0.33249857023583335 0.36867683204057938 -0.32750950397092404 -0.14750941032665479 0.41338488709758769 -0.69644132659983216 0.32230941812801095 0.2818989049893893 -0.16414202962077629 0.049186054548355507 -0.6262945997153353 -0.68477134528116201 0.68797544989811288 -0.48185955919473361 0.12284523888187253 0.42226250076996735 -0.16690563454562515 0.71587952409385547 -0.36621629547589291 -0.06226865137874936 0.21124136316256281 0.10341256312514455 0.014780737612722018;0.39100450846769635 0.088143379340913292 0.26714526869540567 0.10091987779614006 -0.23042762468209022 -0.20675847106960837 -0.0031634648136216071 0.13920000607525695 0.11181025943168763 0.29041523926712831 0.1510875252772424 -0.41175004295846351 -0.11329226079305919 0.15977767672959384 -0.032749731260863932 -0.28315017912017881 0.11136627796947311 -0.21080866180895935 -0.24805509063832845 0.54605393825232829 0.23484527467272687 0.21010922346210731 0.25455582718798436 -0.28688106903881666 -0.4054937352548576 0.051555365999959746 0.31702175155746426 -0.06270978818782437 -0.13072578330035617 -0.21273032530528294 -0.16697092384761963 -0.095474011685422064 0.29401260993481193 0.098329631094534589 0.17009869334465491 -0.34568989227405911 -8.6662822443949903e-05 0.085076085085100311 0.0072844191647108902 0.20441026720829897 -0.06431222931394355 0.15086975531843638 -0.13661003690689519 -0.26578694022903049 -0.19549446605881599 -0.10222128734880231 -0.066631464555876749 0.23819099447749822 0.31273709690877188 0.29216284068949505 -0.051235186782747549 -0.049453451396135148 0.094716963088479766 0.026200762338913015 -0.086046692696455651 -0.088652267616355612 -0.17227239211935982 -0.060180713198411298 0.21580312154937006 0.049849767421101962 -0.51912990824996963 0.53107562570129663 -0.4271028929944411 0.054516520411470287 0.38223629502241058 0.082702613671738007 0.054536816418459914 -0.19960525089678322 -0.12147773380586639 -0.12759174933036543 0.25776627197641533 -0.20552037696016509;-0.12103740976448178 -0.141465199949249 0.0061028597578276561 -0.065263959691002987 -0.24236949308906394 0.15601593696485203 0.24428704444663973 -0.054801483276928915 0.035535687907163299 0.18041532848163747 -0.095639906631356159 -0.026105015079961016 0.24386384149764487 0.044868830661964572 0.24398672225732077 0.0050370881556744832 -0.046030738463464518 -0.029562333283829879 0.28994532372882709 0.11512330206333247 -0.27980978688938068 0.098250680367838641 -0.043663663709721391 0.06044871967326744 -0.16650282361622776 -0.060320461003931319 -0.20936818024860074 0.090813125243597664 0.17967620996061212 -0.097162433666320533 0.06740217246978053 0.25987404042355156 -0.18128474983725151 0.0016811368223322858 0.27650871832360213 0.071428834329477484 0.27104157467926759 -0.11960948547733172 0.014975203060028969 -0.099007206746607221 -0.19432439222409012 0.11715948649337332 0.32726903161298498 -0.24047534365979709 -0.25719827425935965 0.20171081359390378 -0.30225201306260885 0.078873203789307067 0.31337828054171113 -0.27189410071106646 -0.08575252106452258 0.33339318288734077 0.12402292116779517 0.11300679930524424 0.22832314243520968 -0.06332693692030518 -0.14760253645400609 0.072866489446960669 0.20772048062122955 0.12717442461123354 0.30512807044245904 0.18943090656234718 -0.04425429249145791 0.13849596020229443 -0.12219035550811089 0.21633440832345632 0.37506152185434899 -0.26647620172571262 -0.014368831298462083 0.075412040937537089 -0.24009005988915577 -0.09211313256618997;0.14920201593109819 -0.29815214298506243 0.23180992780820472 -0.14264205841643574 0.24347018527613926 0.18205126062679214 0.1074859536191536 -0.09840163254761003 0.057014078200073724 0.17937736105593535 -0.23736565823291023 0.1120614352159148 -0.15038313591292679 0.010417753564305549 -0.18286119904105241 -0.26021940948600658 0.21427977258750039 -0.10506281916884573 0.089712015620450683 -0.070818469034820877 0.18956848342836047 -0.10162782103881264 0.14092527024547502 -0.23392959555287898 -0.73678448514765715 0.2978531658823389 -0.038550850012396311 0.53670112300731621 -0.13956142506437408 0.20462203126566839 -0.17559021398496899 -0.027254296752691653 -0.0022871988162833975 -0.30616826505434214 0.27448047844163626 -0.1136412321856283 -0.31152944563881951 0.20609804567438603 0.17904013337884933 -0.33227754349344368 0.33395850806628202 -0.060425134785751226 0.083503814112797475 -0.004771541579872726 0.037453133267388347 -0.23711868508843714 0.010545163150702603 -0.032735121847739773 0.35066859700250896 -0.022760976510620035 0.022553061169795875 -0.075340543799313139 -0.2220113961140612 0.11367407681424392 -0.91010454788021167 0.40812866717582863 0.36124812904100362 0.48314929652541816 0.14811006909498659 -0.11722331987430519 0.52090257535779361 0.10789992047538606 -0.099974151422252994 0.0064942238837338954 0.19597929045389573 -0.26758780108485253 0.62164577813739574 -0.49798745875856792 0.092385397843301673 -0.0009612582124120196 0.0462984511897538 -0.075828160919070658;0.23000481881899507 -0.11954842310707529 -0.026935450426671829 -0.16007997246133873 0.16176516263204571 0.14612003160698248 0.34110233897470743 -0.0034866251688208689 0.1735232455511839 -0.25469756685599626 -0.065387975288377254 0.088720957545734419 0.24627323085185282 -0.2288087492762293 0.17839452389497967 -0.022563609297652738 0.074845535790029713 -0.080989107764075308 0.74246038851098817 -0.58951607517594007 0.14349678819504214 -0.43550976786852541 -0.19443990359724653 -0.073673129574034296 -0.12445481815145462 0.23525389023085613 -0.03178192282415053 0.28930031318137372 -0.05007591990386101 0.17193901204759368 -0.34798850675486676 0.2773952392689733 -0.12704724775389001 0.20188760335290673 0.29062784891547278 -0.052381414554071748 -0.10109190021732638 -0.27138905185839513 -0.0066674098179105466 0.13759860821489492 -0.12473528652625009 0.025236258966803961 0.24366216316310105 0.084237966482408139 -0.030175470021454556 -0.043310360454250095 -0.25522751790097359 0.2636066388191422 -0.6950727511160868 0.49022337474905342 0.27256697884371162 0.039027336486558289 -0.28139131207332363 0.12681364433224823 -0.31946851528970616 0.36012744397046736 -0.2492479468540803 0.44924104286289873 0.038154185741377668 0.037670527804357284 0.62341181501115583 -0.26963126005796523 0.25822246478252348 -0.29380944395150232 -0.30473349043574627 0.37131015303210374 0.18092538711792253 -0.1269096014757817 0.095819230785369774 0.40783899098347248 -0.01571294188746029 -0.24522090708735672;-0.25041970264493008 0.11264568414074225 -0.07858367877013607 0.0098758527778839127 -0.048148600978137619 0.0058425606744502692 -0.35099102249329001 0.20571997664073088 -0.031022323578458862 -0.042108610462187945 -0.27381000073810824 0.074658500534986114 0.16952551731178142 0.25319455405991576 0.25514303206058758 -0.14996237844234936 0.13829007595012999 -0.28740137977765207 0.022870451782491891 0.032147717961226736 -0.13669881414840807 0.24825795027264871 0.37479144851770257 -0.29284711123596385 -0.030791850735772668 -0.0066293435448935472 -0.041749921502690683 0.23598393180254271 0.24060763587954015 0.014896294096202203 -0.20875176066160023 0.16701879714819542 0.29881107526865253 0.10130597704368763 -0.19650674955001804 0.17060568411340127 0.17466564754257768 0.16698625114695159 0.2972140256897598 0.08954177221349012 -0.14239488222386965 -0.2690169108265098 0.0034796831826506528 -0.21972068813970266 -0.11882049901304746 0.14245443860571771 -0.078886513510041834 0.23514985224222046 -0.0094786981137463238 -0.028785331701903429 0.011013508346317738 -0.19459699258560992 0.0036069816242164901 0.28487967292549621 -0.085698495041226508 -0.1024310488359817 0.25878746075751102 0.092585601654615199 0.1658095798035859 0.17352723728964661 -0.22337619861989577 0.38158030943010107 -0.23215777214293401 -0.027617933690785506 -0.16645606369888605 -0.26697942219049914 -0.15476934474047999 0.13128999637250749 -0.23173093118731816 -0.049551825303705485 0.052940515447034743 0.096974889647810522;0.080269713959466138 -0.2109810913199677 0.015568781185573369 -0.022324543611571653 -0.31700677866840132 -0.082849383059048307 -0.3093862250618189 -0.075339743108436816 0.21313038702555037 0.26744022362860048 0.087473257402886542 0.1067883684728692 -0.16815147212459033 -0.0089390969718724268 -0.063616595759326516 -0.22686497436148267 0.24315109657433595 0.022596919735436809 0.24439789744031459 0.31637294051041953 -0.25850577461460122 -0.13422551396106897 0.16137017687332486 -0.23536012748291821 0.22693914043342214 0.06839566066333623 0.071690327656494232 -0.39537089060011033 -0.025593235651163938 0.20118837845381005 -0.27088114569240657 0.055464032957632102 -0.23061302726821245 -0.19006142660281833 -0.024550583072625334 -0.18637813604981904 0.21812501558030142 0.090737257940587665 -0.14168055839842003 -0.23869892493885278 0.021119694307460031 0.18977453585260134 -0.11759726014744162 -0.06125029207316391 -0.17584756555747133 0.10840938939076872 -0.012856852223774666 -0.23145356618034296 -0.098294082863484775 0.10958239230296422 0.057224594545996925 0.13148425460566765 0.23450503721012436 -0.068548640117052195 0.10088405882766208 -0.42892102966812057 -0.19813034666303292 -0.1250453968645808 0.081093536106787698 0.15071152055726594 0.1387466930688751 0.1100588408082056 0.085727999571269184 -0.15282538500352774 -0.11187256026726243 0.18679636625932591 -0.1435704123707936 0.22641317302533587 -0.21002058209255986 0.021115916701885631 -0.3012144403701093 -0.020127634849602602;-0.84856139452751289 1.0199462794658372 -0.32540860322971621 0.011073240131537685 -0.062218601063134774 0.036936660760346005 -0.22639382661136634 0.19490237471098804 0.033886649310715215 -0.21902423756113765 0.31275436588644107 0.21978341664479695 -0.46546509288189936 0.40114534160417592 0.42486994653902505 -0.26259705420193308 -0.25448278959767473 0.34082595098249296 -0.47635622700311453 0.52130304334221722 0.35918929669645061 0.072555119953958191 0.2446524590687533 -0.16376675380757824 1.7813687682432195 -0.48010363615793905 0.40379417782510496 -0.8623587398126954 -0.24112546395502177 -0.0095394664754094773 0.46056286638798394 -0.44706586711383212 -0.10059047826010642 0.08130115587690985 -0.026320129781488559 0.20628885593361193 0.3474953629916564 0.28940472833420694 -0.012945265751179458 -0.22166121664249586 -0.14224522590801184 -0.14345690291141996 0.049275233592934634 0.17274106684706222 -0.38797667134823616 -0.4986477361798633 0.53933452243252256 -0.39382296266272548 0.23286583199415423 -0.5861843970416416 -0.91638564427846558 0.90820192564185864 0.60069024867620591 -0.33953013690196221 2.5245647900471777 -1.1425649959236563 -0.42160466526315687 -1.4326845902479275 0.30195943187900842 0.81133474159249908 -1.1553238666200008 0.51963587947857626 0.22092781350493818 0.90207818801951833 0.19548559877806884 0.078223101792904967 -2.3300634971144607 1.0830348810655845 -0.32896347979946994 -0.83376757800092505 -0.0068438291919436607 -0.014266294539760001;-0.028798967011691004 -0.23296251536253315 0.22314954551970922 -0.27879240405398803 -0.15244177643284262 0.24488076794515493 -0.045684447277890838 -0.01423502476866634 -0.065895941559368496 0.41417307182516211 -0.2001276957611284 -0.3400461159159916 0.20004353979166098 -0.40714170406689354 -0.28283305119868335 0.28950404779597727 0.26376958139533108 0.084568156331997268 -0.011916664084876873 -0.19715823998623278 0.15158169206939273 0.078141539140503383 0.23565157194167094 -0.25309425239720268 0.014178228641638093 0.019497943007585603 0.042893855935931459 0.39141026112308624 0.046437577911818954 0.025112765363092579 0.053566751990481942 -0.11806100712462264 0.20763373421552733 0.31209039696785384 0.24453760744324063 0.105238427562919 -0.17632855179276849 -0.28202857360012645 0.13257025305701362 0.30823916210320684 -0.068521803923934699 0.029846914553589891 0.10944331014002456 0.22550769253213415 0.29735171229748042 0.23276412146592518 -0.32351407941485644 0.16356285330582407 0.0034476959801487956 -0.078774866882661748 0.011804663922223315 -0.050669333284582167 -0.049346560289399252 -0.071200191939850971 0.059988509493314794 0.10935347708540037 -0.059045415190335265 0.017663938729549397 -0.020311384681899032 0.094733059899455338 -0.045559420276858491 -0.021375148235928162 -0.31343129426368821 -0.089182407014102988 0.3326219695850216 0.084693347575742539 -0.13086308950275624 0.14237401611900996 0.10394982298099696 -0.26521238788343571 -0.22116721053586014 -0.12350103629972173;0.14378949865016644 -0.098404074259170179 -0.042789836157195345 0.24370252457224678 0.21685810472761677 0.14646585387194752 -0.25842705306830593 -0.021303519222611131 0.033328502225092725 0.031617227576018002 -0.35723773212593196 0.17451309580751667 0.36357559370115627 0.14425755218220121 -0.21058743313873812 -0.079867197007962534 0.28220766600023828 -0.020848013047899638 0.29998279895549845 -0.48239810216676088 -0.15819908689169143 0.092816200512349886 0.11504915260910319 0.022116724856157136 -0.094487964267492133 0.13482363192562627 0.030163727817898219 -0.022647670553779205 -0.013082656683181475 -0.10251200636687328 -0.28527799866666448 0.31951127025959958 -0.33552599990572451 0.13153471641218065 0.18420177076579478 -0.0073884338997285085 0.00466396367898136 0.31539001411215117 -0.34762471831513603 -0.061390155940329393 0.18038577580901274 0.1199045360352593 0.457761697937831 -0.16730406347723367 0.27208173055121376 0.052992575094778671 0.1321468024673193 0.27418445757946702 -0.087517324438909777 -0.17207691391921007 -0.1447198681450837 0.27147825554847266 -0.26658632122945003 -0.17752326438766974 -0.39343798491556042 0.15796056230758093 0.166189254102978 -0.11530243820740295 0.10304267142785219 -0.023534754214625687 0.55940070218875071 -0.1094882339415099 0.041507047757768464 -0.36834204807364418 0.21686400223558622 -0.21657810495359067 0.50156410593241563 -0.20603365433360452 -0.02697746923316776 -0.11388849295843757 0.088193327495201326 0.20319596088628095];

% Layer 2
b2 = [0.91209708709574611;-0.18148821688503869;0.1290512125241782];
LW2_1 = [0.74007942146033734 -0.33456074245093914 -0.63051687292539893 -0.89911653388058177 0.74989290231649131 3.7277233776879597 1.0264074341655014 -0.52155018904521877 0.39552458157235071 -0.49423853593491235 0.94359542952806197 0.38575106472968274 -3.7026938561009413 0.57744734837287393 0.15338168633714203;-0.39866963279598966 1.0294863747799192 -2.0156804482451349 -0.57323086477502316 0.043735532986636044 -1.0434941086902518 0.6141467997208403 -0.6901182686780426 -1.7068244997018158 -1.9056775192808966 1.029096280427737 0.87244957235439735 4.805556519324691 -0.72613930745932043 -1.1110265855909622;0.17927043895482137 1.6129544866503469 2.3346176006415602 -0.27071341222044726 0.23980641794641414 -2.66244196576254 -0.84435558231583807 0.22676061415521143 -0.79832888834798077 1.5240149141954304 -0.099580461792880409 0.43895086033822789 -1.5213334048275167 -0.63197169657872265 0.046411943685834373];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
